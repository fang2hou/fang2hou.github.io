<!doctype html><html dir=ltr lang=zh-cn data-theme><head><title>fang2hou | 树莓派搞机日记（二）</title><meta charset=utf-8><meta name=generator content="Hugo 0.82.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="硕士研究生 @ 筑波大学
全栈工程师
"><link rel=stylesheet href=/css/style.min.51d7ec6db610dce512b735d5315f963c278042d026aa4ebe05a9355460b49016.css integrity="sha256-UdfsbbYQ3OUStzXVMV+WPCeAQtAmqk6+Bak1VGC0kBY=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS+yuWSR4=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/fang2hou.min.5dcfc4fe6e8d9dfd21d052c4b727fb736e81f6847db49c62ec3e90a9423c7770.css integrity="sha256-Xc/E/m6Nnf0h0FLEtyf7c26B9oR9tJxi7D6QqUI8d3A=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous><link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=canonical href=/post/raspberry-pi-guide-02/><script type=text/javascript src=/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin=anonymous></script><script type=text/javascript src=/js/anatole-theme-switcher.min.7fd87181cdd7e8413aa64b6867bb32f3a8dc242e684fc7d5bbb9f600dbc2b6eb.js integrity="sha256-f9hxgc3X6EE6pktoZ7sy86jcJC5oT8fVu7n2ANvCtus=" crossorigin=anonymous></script><script type=text/javascript src=/js/fang2hou.min.25a2c81d7b60d995d6e2720e34109851ca2d5fbf02d170edfe6fe4c0efb2f4ad.js integrity="sha256-JaLIHXtg2ZXW4nIONBCYUcotX78C0XDt/m/kwO+y9K0=" crossorigin=anonymous></script><meta name=twitter:card content="summary"><meta name=twitter:title content="树莓派搞机日记（二）"><meta name=twitter:description content="初识树莓派 树莓派的元件都在表面，没有什么好特殊介绍的，自己上手翻着看一会应该就能对它熟悉了。这里想花点笔墨说下树莓派的针脚。
树莓派的针脚排布是有点混乱的，要辨识针脚，首先，请你按照下图的方向可以举起你手中的树莓派。
然后我们打开 Raspberry Pi Pinout，在这个页面上，你可以清晰的看到各个针脚代表的编码。
而树莓派有 3 种不同的模式来约束针脚的使用："></head><body><div class="sidebar animated fadeInDown"><div class=logo-title><div class=title><div class=avatar><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 61.47 85.63"><defs><style>.cls-1,.cls-2{fill:none}.cls-1,.cls-2,.cls-3,.cls-4{stroke:#231f20;stroke-miterlimit:10}.cls-2,.cls-4{stroke-linecap:round}</style></defs><g id="Layer_2" data-name="Layer 2"><g id="Layer_1-2" data-name="Layer 1"><path class="cls-1" d="M31.91 85.13c6.64-.19 11.15-5 14.08-8.15a34.76 34.76.0 008-15.11c1.09-4 .87-8.1 1.51-12.18C56.08 46 56.84 45.12 58 41l.13-.45a111.64 111.64.0 002.81-13.95c.46-6.7-4.42-14.78-10.36-19.65C41-1 29.61.49 27 .83A32.75 32.75.0 008.66 9.72c-2.31 2.26-6.13 6-7.56 12-2 8.23 1.37 17.47 3.26 21 0 .09.4.79.79 1.78.0.0.32.79.59 1.61A37.5 37.5.0 017.13 54.5 38.17 38.17.0 009.84 65.87a31.37 31.37.0 008.3 12.74c2.86 2.56 7.46 6.7 13.77 6.52z"/><path class="cls-2" d="M52.5 36.25c-5.33-5.34-14.37-1.81-14.37-1.81"/><path class="cls-2" d="M10.33 36.25c5.33-5.34 14.37-1.81 14.37-1.81"/><path class="cls-1" d="M15.74 54.45c.28.07 6.37 1.43 10.24-2.84.18-.19 3.84-4.33 2.25-7.91-1.45-3.28-6.19-3.59-8.86-3.77-3.5-.23-9.22.44-10.18 3.27a8.9 8.9.0 00.16 2.27c0 .1.0.21.0.32a33.7 33.7.0 001.13 5.31C11.85 53.51 14.8 54.22 15.74 54.45z"/><path class="cls-1" d="M47.28 54.45c-.28.07-6.36 1.43-10.23-2.84-.18-.19-3.84-4.33-2.25-7.91 1.45-3.28 6.18-3.59 8.86-3.77 3.5-.23 9.22.44 10.18 3.27.24.73-.93 7.16-1.34 7.9C51.18 53.51 48.23 54.22 47.28 54.45z"/><line class="cls-1" x1="28.63" y1="45.79" x2="34.4" y2="45.79"/><path class="cls-2" d="M23.51 69a24.85 24.85.0 007.92 1.55 23.63 23.63.0 008.09-1.39"/><path class="cls-1" d="M58 41a11.27 11.27.0 011.32 3.14c.55 2.19.23 4-.44 7.41-.75 3.86-1.47 4.87-1.89 5.37a7.73 7.73.0 01-2.39 1.9"/><path class="cls-2" d="M3.79 41a10.7 10.7.0 00-1.32 3.14c-.55 2.19-.23 4 .44 7.41.75 3.86 1.47 4.87 1.89 5.37a7.71 7.71.0 002.38 1.9"/><path class="cls-3" d="M50.58 6.9C41-1 29.61.49 27 .83A32.75 32.75.0 008.66 9.72c-2.31 2.26-6.13 6-7.56 12-2 8.23 1.37 17.47 3.26 21 0 .09.4.79.79 1.78.0.0.32.79.59 1.61.21.66.39 1.34.54 2a21 21 0 00.6-3.65c.24-3.61-.86-4-.74-8.74.06-2.47.24-9.92 4.15-11.85 1.55-.77 2.42.0 5.18.15 9.35.63 19.67-6.32 23.26-8.74a3.39 3.39.0 012.07-.89c3.55.18 3.42 9.28 10.37 14.37 1.78 1.3 2.32 1.1 3.41 2.37 3 3.48 1.28 7.75 2.08 11.41A7.72 7.72.0 0057.07 44c.28-.82.58-1.77.93-3l.13-.45a111.64 111.64.0 002.81-13.95C61.4 19.85 56.52 11.77 50.58 6.9z"/><path class="cls-2" d="M26.18 59.9a3.44 3.44.0 011.28-.18c1 .07 1.28.66 2.23 1.05a4.91 4.91.0 003.19.0c1.13-.39 1.24-1 2.26-1.21a3.5 3.5.0 012.06.31"/><path class="cls-1" d="M6.4 48.74c-.74-2.83 2.95-3.27 2.95-3.27"/><path class="cls-1" d="M55.82 48a2.57 2.57.0 00-2.07-3.1"/><path class="cls-2" d="M24.33 45.6c-1.82-2.56-8.19-1.65-9-.25"/><path class="cls-4" d="M18.63 45.58c0 1.83 3.05 1.83 3 0s-3.03-1.83-3 0z"/><path class="cls-2" d="M39.62 45.3c1.82-2.56 8.19-1.65 9-.24"/><path class="cls-4" d="M45.32 45.28c0 1.84-3 1.84-3 0s3.03-1.83 3 0z"/></g></g></svg></div><h3 title><a href=/>方舟</a></h3><div class=description><p>硕士研究生 @ 筑波大学<br>全栈工程师<br></p></div></div></div><ul class=social-links><li><a href=https://www.linkedin.com/in/zhou-fang-cn/ rel=me aria-label=Linkedin><i class="fab fa-linkedin fa-2x" aria-hidden=true></i></a></li><li><a href=https://github.com/fang2hou/ rel=me aria-label=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li><a href=https://twitter.com/fang2hou rel=me aria-label=twitter><i class="fab fa-twitter fa-2x" aria-hidden=true></i></a></li><li><a href=mailto:iszhoufang@gmail.com rel=me aria-label=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul><div class=footer><div class=lang-switcher><p id=lang-notification></p><ul><li><a href=https://fang2hou.com/ onmouseover='languageNotify("中文")' onmouseleave=languageNotify(null)><img class=flag src=/images/flags/zh-cn.svg></a></li><li><a href=https://fang2hou.com/ja/ onmouseover='languageNotify("日本語")' onmouseleave=languageNotify(null)><img class=flag src=/images/flags/ja.svg></a></li><li><a href=https://fang2hou.com/en/ onmouseover='languageNotify("English")' onmouseleave=languageNotify(null)><img class=flag src=/images/flags/en.svg></a></li></ul></div><div class=by_farbox>&copy; fang2hou 2012-2021</div></div></div><div class=main><div class="page-top animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><ul class=nav id=navMenu><li><a href=/ title>关于</a></li><li><a href=/post/ title>文章</a></li><li><a href=/project/ title>项目</a></li><li class=lang-switcher-nav><a href=/ title=中文><img class=flag src=/images/flags/zh-cn.svg> 中文</a></li><li class=lang-switcher-nav><a href=/ja/ title=日本語><img class=flag src=/images/flags/ja.svg> 日本語</a></li><li class=lang-switcher-nav><a href=/en/ title=English><img class=flag src=/images/flags/en.svg> English</a></li><li class=theme-switch-item><a class=theme-switch title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></li></ul></div><div class=autopagerize_page_element><div class=content><div class="post animated fadeInDown"><div class=post-content><div class=post-title><h3>树莓派搞机日记（二）</h3><div class=info><em class="fas fa-calendar-day"></em><span class=date>2019 年 2 月 11 日</span>
<em class="fas fa-stopwatch"></em><span class=reading-time>阅读时间 2 分钟</span></div></div><h1 id=初识树莓派>初识树莓派</h1><p>树莓派的元件都在表面，没有什么好特殊介绍的，自己上手翻着看一会应该就能对它熟悉了。这里想花点笔墨说下树莓派的针脚。<br>树莓派的针脚排布是有点混乱的，要辨识针脚，首先，请你按照下图的方向可以举起你手中的树莓派。</p><p><img src=pi.png alt="USB 向下放置树莓派"></p><p>然后我们打开 <a href=https://pinout.xyz>Raspberry Pi Pinout</a>，在这个页面上，你可以清晰的看到各个针脚代表的编码。<br>而树莓派有 3 种不同的模式来约束针脚的使用：</p><ol><li><strong>RPi.GPIO.BOARD</strong> 完全按照 <code>1, 2, 3, ...</code> 这样顺序排列的。</li><li><strong>RPi.GPIO.BCM</strong> 针脚图上写着 <code>BCM 1</code>，<code>BCM 2</code> 这样的。</li><li><strong>WiringPi</strong>（类 Arduino）<a href=https://pinout.xyz/pinout/wiringpi>专用针脚图</a></li></ol><p>使用上全凭使用者的喜好，个人喜欢 BCM 一点。</p><p><code>RPi.GPIO</code> 库可以通过下面的命令来安装</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo pip3 install RPi.GPIO
</code></pre></div><p><code>WiringPi</code> 库可以通过下面的命令来安装：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo pip3 install WiringPi
</code></pre></div><p><code>WiringPi</code> 的 Python 使用者应该读一下 <a href=https://github.com/WiringPi/WiringPi-Python>项目的 Github 主页</a>。<br>其实不光是针脚的使用方式了，就连函数调用都和 Arduino 非常相似。<del>高仿</del></p><p>如果像我一样比较懒，可以去购买一块带有标识板子，插在面包板上也方便连接。</p><p><img src=myboard.png alt=懒人面包板></p><h1 id=推荐库>推荐库</h1><p><strong>GPIO Zero</strong>，一个 GPIO 增强库，包含了非常多的预设功能，如 LED，按钮，电机控制等等。<br>在带有桌面环境的 <code>Raspbian</code> 已经自带，如果是使用命令行版本的用户，可以通过下面命令安装。</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo pip3 install gpiozero
</code></pre></div><p>安装后在命令行输入 <code>pinout</code>，你就会发现一个命令行版本的针脚图。<br>关于此库更多的功能我将会在之后的搞机日记中展开。</p><h1 id=双色-led-实验>双色 LED 实验</h1><h2 id=元件介绍>元件介绍</h2><p>LED 是非常简单的电子元件，适合我们用于第一次进行正式的树莓派学习。</p><p>首先，我先介绍一下我的双色 LED 元件，支持发出红色和绿色光。</p><p>{% asset_img rg.png 双色 LED 元件 %}</p><p>从图中可以看到，该元件有三个针脚。最接近 <code>-</code> 的针脚代表该针脚接地。右边两个针脚分别对应 R，G，属于 Singal 针脚，缩写为 <code>S</code>。</p><h2 id=连接方式>连接方式：</h2><p>采用比较简单的连接方式：</p><ol><li>橙色线代表 <code>R</code> 针脚，接入 <code>BCM 17</code></li><li>绿色线代表 <code>G</code> 针脚，接入 <code>BCM 18</code></li><li>白色线代表 <code>GND</code> 针脚， 接入 <code>GND</code></li></ol><p><img src=rg_connection.png alt="双色 LED 连接"></p><h2 id=范例代码-01>范例代码 01</h2><p>首先我们得让我们的 LED 亮起来，原理非常简单，只要给相应针脚一个高电压即可。<br>这是第一次代码范例，注释会尽量详细一点。如果对 Python 不熟悉的话，通过下面的代码注释应该有一些启发，只要能理解这次的流程，那么后面就不是很难了。毕竟，Python 封装了非常多的实用库，主要还是流程细节的设计。</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=c1># 导入 GPIO 库</span>
<span class=kn>import</span> <span class=nn>RPi.GPIO</span> <span class=kn>as</span> <span class=nn>GPIO</span>

<span class=c1># 定义用于 LED 的针脚 BCM 编号</span>
<span class=n>LED_R</span> <span class=o>=</span> <span class=mi>17</span>
<span class=n>LED_G</span> <span class=o>=</span> <span class=mi>18</span>

<span class=c1># 设定针脚编号为 BCM 模式</span>
<span class=n>GPIO</span><span class=o>.</span><span class=n>setmode</span><span class=p>(</span><span class=n>GPIO</span><span class=o>.</span><span class=n>BCM</span><span class=p>)</span>

<span class=c1># 设定 LED 针脚可用于输出</span>
<span class=n>GPIO</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>LED_R</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>OUT</span><span class=p>)</span>
<span class=n>GPIO</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>LED_G</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>OUT</span><span class=p>)</span>

<span class=c1># 关于 __name__ == &#34;__main__&#34;：</span>
<span class=c1># 如果是直接运行本代码，而不是其他 Python 代码调用本文件的话，则会执行</span>
<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>while</span> <span class=bp>True</span><span class=p>:</span>
            <span class=c1># 给两个针脚电压</span>
            <span class=n>GPIO</span><span class=o>.</span><span class=n>output</span><span class=p>(</span><span class=n>LED_R</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>HIGH</span><span class=p>)</span>
            <span class=n>GPIO</span><span class=o>.</span><span class=n>output</span><span class=p>(</span><span class=n>LED_G</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>HIGH</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
        <span class=c1># 检测到中断信号后，关闭 GPIO 通道以供下次使用</span>
        <span class=n>GPIO</span><span class=o>.</span><span class=n>cleanup</span><span class=p>()</span>
        <span class=c1># 退出返回状态代码 6</span>
        <span class=nb>exit</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</code></pre></div><h2 id=范例代码-02>范例代码 02</h2><p>通过上一节，我们已经可以通过常规的方式进行点灯了，但如果只是这样的话太单调了，接下来我们尝试让双色 LED 进行颜色渐变。<br>这里，我打算用 <code>PWM</code>（脉宽调制，Pulse Width Modulation）方法来控制两个 LED 的明暗。</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>RPi.GPIO</span> <span class=kn>as</span> <span class=nn>GPIO</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=n>LED_R</span> <span class=o>=</span> <span class=mi>17</span>
<span class=n>LED_G</span> <span class=o>=</span> <span class=mi>18</span>

<span class=n>GPIO</span><span class=o>.</span><span class=n>setmode</span><span class=p>(</span><span class=n>GPIO</span><span class=o>.</span><span class=n>BCM</span><span class=p>)</span>

<span class=n>GPIO</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>LED_R</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>OUT</span><span class=p>)</span>
<span class=n>GPIO</span><span class=o>.</span><span class=n>setup</span><span class=p>(</span><span class=n>LED_G</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>OUT</span><span class=p>)</span>

<span class=n>pwm_r</span> <span class=o>=</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>PWM</span><span class=p>(</span><span class=n>LED_R</span><span class=p>,</span> <span class=mi>2000</span><span class=p>)</span>
<span class=n>pwm_g</span> <span class=o>=</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>PWM</span><span class=p>(</span><span class=n>LED_G</span><span class=p>,</span> <span class=mi>2000</span><span class=p>)</span>

<span class=n>GPIO</span><span class=o>.</span><span class=n>output</span><span class=p>(</span><span class=n>LED_R</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>LOW</span><span class=p>)</span>
<span class=n>GPIO</span><span class=o>.</span><span class=n>output</span><span class=p>(</span><span class=n>LED_G</span><span class=p>,</span> <span class=n>GPIO</span><span class=o>.</span><span class=n>LOW</span><span class=p>)</span>

<span class=n>pwm_r</span><span class=o>.</span><span class=n>start</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<span class=n>pwm_g</span><span class=o>.</span><span class=n>start</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>

<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>while</span> <span class=bp>True</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
                <span class=n>pwm_r</span><span class=o>.</span><span class=n>ChangeDutyCycle</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
                <span class=n>pwm_g</span><span class=o>.</span><span class=n>ChangeDutyCycle</span><span class=p>(</span><span class=mi>100</span> <span class=o>-</span> <span class=n>i</span><span class=p>)</span>
                <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=o>.</span><span class=mi>25</span><span class=p>)</span>

            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
                <span class=n>pwm_r</span><span class=o>.</span><span class=n>ChangeDutyCycle</span><span class=p>(</span><span class=mi>100</span> <span class=o>-</span> <span class=n>i</span><span class=p>)</span>
                <span class=n>pwm_g</span><span class=o>.</span><span class=n>ChangeDutyCycle</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
                <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=o>.</span><span class=mi>25</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
        <span class=n>pwm_r</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
        <span class=n>pwm_g</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
        <span class=n>GPIO</span><span class=o>.</span><span class=n>cleanup</span><span class=p>()</span>
        <span class=nb>exit</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</code></pre></div><h2 id=总结>总结</h2><p><img src=rg_led.png alt="双色 LED 实际效果"></p><p>通过运行代码实例不难看出，双色 LED 在混色上效果其实并不好，但是纯红色或是纯绿色的表现很好，这也是这类双色 LED 多用作状态指示灯的原因之一。关于混色，其实还得靠 RGB 三色 LED 来实现。关于 RGB 三色 LED 的简单实验，我将在下一篇日记之中继续介绍。</p></div><div class=post-footer><div class=info><span class=separator><a class=tag href=/tags/led/>LED</a><a class=tag href=/tags/raspberry-pi/>Raspberry Pi</a></span></div></div></div></div></div></div><script type=text/javascript src=/js/medium-zoom.min.2d6fd0be87fa98f0c9b4dc2536b312bbca48757f584f6ea1f394abc9bcc38fbc.js integrity="sha256-LW/Qvof6mPDJtNwlNrMSu8pIdX9YT26h85SrybzDj7w=" crossorigin=anonymous></script></body></html>